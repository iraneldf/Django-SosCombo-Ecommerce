{% extends 'pages/includes/base.html' %}
{% load static %}
{% block css %}
    <link href="{% static 'css/paginasSecundarias.css' %}" rel="stylesheet" type="text/css">
    <link href="{% static 'css/modalTusOrdenes.css' %}" rel="stylesheet" type="text/css">
    <link href="{% static 'css/bootstrap.css' %}" rel="stylesheet" type="text/css">
{% endblock %}
{% block content %}
   {% include 'pages/includes/pago/formularioClasico.html' %}
{% endblock %}

{% block ExtrasJS %}

    {#    <script src="{% static 'js/pago.js' %}"></script>#}
    <script src="{% static 'js/bootstrap.js' %}"></script>
    <script>

        function ajaxFunction(url, parameters, type, callback, async = true) {
            $.ajax({
                url: url,
                type: type,
                data: parameters,
                dataType: 'json',
                processData: false,
                contentType: false,
                async: async
            })
                .done(function (data) {
                    // callback(data)
                    if (!data.hasOwnProperty('error')) {
                        callback(data)
                        return false
                    }
                })
                .fail(function (jqXHR, textStatus, errorThrown) {
                    alert(textStatus + ': ' + errorThrown)
                })
                .always(function (data) {
                })
        }

        window.addEventListener('load', multiply)
        window.addEventListener('load', total_sum)

        var result = 0
        var asd = 0


        function multiply() {
            {% for key,value in request.session.cart.items %}
                result = parseFloat({{ value.quantity|safe }}) * parseFloat({{ value.product.precio|safe  }});
                document.getElementById("resultado{{ value.product.id }}").innerHTML = result.toFixed(2);
            {% endfor %}
        }

        function total_sum() {
            let sum = 0
            {% for key,value in request.session.cart.items %}
                asd = parseFloat({{ value.quantity }}) * parseFloat({{ value.product.precio|safe  }})
                sum = sum + asd;
            {% endfor %}
            document.getElementById("subtotal").innerHTML = "$" + sum.toFixed(2);
            document.getElementById("total").innerHTML = "$" + (sum + parseFloat({{  general.precio|safe }})).toFixed(2);
            return parseFloat(sum + parseFloat({{ general.precio|safe }}))
        }

    </script>
{% endblock %}

